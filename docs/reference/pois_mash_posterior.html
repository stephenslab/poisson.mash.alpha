<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute Posterior Summaries From Poisson Mash Fit — pois_mash_posterior • poisson.mash.alpha</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Posterior Summaries From Poisson Mash Fit — pois_mash_posterior"><meta property="og:description" content="Compute posterior summaries of the given contrasts of
  the matrix of effects based on the poisson mash fit. Mixture
  components with very small posterior weights are ignored in the
  posterior calculations.
Note this is an internal function which users might not want to
  call directly."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">poisson.mash.alpha</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1-88</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/stephenslab/poisson.mash.alpha" class="external-link">Source</a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute Posterior Summaries From Poisson Mash Fit</h1>
    <small class="dont-index">Source: <a href="https://github.com/stephenslab/poisson.mash.alpha/blob/HEAD/R/pois_mash_posterior.R" class="external-link"><code>R/pois_mash_posterior.R</code></a></small>
    <div class="hidden name"><code>pois_mash_posterior.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute posterior summaries of the given contrasts of
  the matrix of effects based on the poisson mash fit. Mixture
  components with very small posterior weights are ignored in the
  posterior calculations.</p>
<p>Note this is an internal function which users might not want to
  call directly.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">pois_mash_posterior</span><span class="op">(</span>
  <span class="va">data</span>,
  <span class="va">s</span>,
  <span class="va">mu</span>,
  <span class="va">psi2</span>,
  bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span>,
  <span class="va">wlist</span>,
  <span class="va">Ulist</span>,
  <span class="va">ulist</span>,
  ulist.epsilon2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1e-08</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ulist</span><span class="op">)</span><span class="op">)</span>,
  <span class="va">zeta</span>,
  thresh <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">500</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">zeta</span><span class="op">)</span><span class="op">)</span>,
  C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,
  res.colnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="st">"-mean"</span><span class="op">)</span>,
  posterior_samples <span class="op">=</span> <span class="fl">0</span>,
  median_deviations <span class="op">=</span> <span class="cn">FALSE</span>,
  seed <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>J x R matrix of counts collapsed over conditions, with
features as rows and conditions as columns.</p></dd>


<dt>s</dt>
<dd><p>Numeric vector of length R adjusting for sequencing depth of
each of R conditions.</p></dd>


<dt>mu</dt>
<dd><p>J x R matrix of gene-specific means (R conditions are
assumed to belong to M subgroups, so each row should have at most M
distinct values).</p></dd>


<dt>psi2</dt>
<dd><p>Vector of length J giving the gene-specific dispersion
parameters.</p></dd>


<dt>bias</dt>
<dd><p>J x R matrix of bias caused by unwanted
variation. Default is a matrix of all zeros.</p></dd>


<dt>wlist</dt>
<dd><p>Numeric vector of length L specifying the scaling
factors for the prior covariance matrices.</p></dd>


<dt>Ulist</dt>
<dd><p>List of H full-rank covariance matrices</p></dd>


<dt>ulist</dt>
<dd><p>List of G numeric vectors each of which forms a
rank-1 covariance matrix.</p></dd>


<dt>ulist.epsilon2</dt>
<dd><p>Numeric vector of length G added to the
diagonals of each rank-1 prior covariance matrix.</p></dd>


<dt>zeta</dt>
<dd><p>J x K matrix of posterior weights, where K = L*(H + G) is
the number of prior mixture components.</p></dd>


<dt>thresh</dt>
<dd><p>Posterior weights thresholds. Below this threshold, the
mixture components are ignored in the posterior calculations.</p></dd>


<dt>C</dt>
<dd><p>Q x R matrix of contrasts for effects.</p></dd>


<dt>res.colnames</dt>
<dd><p>Character vector of length Q giving the names
of the contrasts.</p></dd>


<dt>posterior_samples</dt>
<dd><p>The number of samples to be drawn from the
posterior distribution of each effect.</p></dd>


<dt>median_deviations</dt>
<dd><p>Logical scalar indicating whether to calculate
posterior summary of deviation of condition-specific effects 
relative to the median over all conditions.</p></dd>


<dt>seed</dt>
<dd><p>a random number seed to use when sampling from the posteriors.
It is used when <code>posterior_samples &gt; 0</code> 
or <code>median_deviations = TRUE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The return value is a list with the following components:</p>
<dl><dt>PosteriorMean</dt>
<dd><p>J x Q matrix of posterior means.</p></dd>


<dt>PosteriorSD</dt>
<dd><p>J x Q matrix of posterior standard deviations.</p></dd>


<dt>ZeroProb</dt>
<dd><p>J x Q matrix in which each entry is the posterior
  probability of the true effect being zero.</p></dd>


<dt>NegativeProb</dt>
<dd><p>J x Q matrix in which each entry is the
  posterior probability of the true effect being negative.</p></dd>


<dt>lfsr</dt>
<dd><p>J x Q matrix of local false sign rate estimates.</p></dd>


<dt>PosteriorSamples</dt>
<dd><p>J x R x posterior_samples array of samples of effects, 
if <code>posterior_samples &gt; 0</code>.</p></dd>


<dt>beta_median_dev_post</dt>
<dd><p>a list containing posterior summary of 
deviation of effects relative to the median, 
if <code>median_deviations = TRUE</code>.</p></dd>

</dl></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yusha Liu, Peter Carbonetto, Matthew Stephens.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

